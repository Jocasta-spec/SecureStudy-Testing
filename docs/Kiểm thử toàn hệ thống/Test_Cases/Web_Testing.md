# Tài liệu Kiểm thử Web

## Tổng quan
Tài liệu này chứa các trường hợp kiểm thử cho ứng dụng web SecureInsure-Testing, là một phần của dự án nhóm hai người dưới chủ đề "Nghiên cứu về Bảo mật API và Ứng dụng của nó trong Xây dựng Ứng dụng Đa Nền tảng (Thạc sĩ Võ Ngọc Tấn Phước)".

## 5.2. Danh sách các tình huống kiểm thử
| STT | Mã testcase           | Tên testcase                              | Mô tả                                                                 |
|-----|-----------------------|-------------------------------------------|----------------------------------------------------------------------|
| 1   | TC_CUSTOMER_WEB_LOGIN_01 | Đăng nhập thành công với tài khoản Customer tồn tại qua /login | Từ trang chủ, chọn "đăng nhập", nhập email và mật khẩu hợp lệ, kiểm tra thông báo thành công. |
| 2   | TC_CUSTOMER_WEB_LOGIN_02 | Đăng nhập thất bại với tài khoản Customer bị chặn qua /login | Từ trang chủ, chọn "đăng nhập", không nhập email, kiểm tra thông báo lỗi. |
| 3   | TC_ADMIN_WEB_ADDUSER_01  | Thêm Admin mới thành công                | Thêm user mới, kiểm tra giao diện và database, dự kiến lỗi.          |
| 4   | TC_ADMIN_WEB_ADDUSER_02  | Thêm Admin với email đã tồn tại          | Thêm user mới, kiểm tra giao diện và database, dự kiến lỗi.          |
| 5   | TC_ADMIN_WEB_EDITUSER_01 | Sửa thông tin Khách hàng thành công      | Sửa thông tin user, kiểm tra database, giao diện hiển thị, đảm bảo thành công. |
| 6   | TC_ADMIN_WEB_DELETEUSER_01 | Xóa Khách hàng thành công               | Xóa user, kiểm tra giao diện và database, đảm bảo thành công.        |

## 5.3. Đặc tả Test Case
### 5.3.1. Trường hợp Kiểm thử Actor Customer (Nền tảng Web)
| ID trường hợp thử nghiệm    | Mô tả trường hợp thử nghiệm                              | Tiền điều kiện                                                                 | Các bước kiểm tra                                                                 | Dữ liệu thử nghiệm                                                                                   | Kết quả mong đợi                                                                                           | Kết quả thực tế                                                                                           | Vượt qua/thất bại (P/F) |
|-----------------------------|----------------------------------------------------------|--------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|-------------------------|
| TC_CUSTOMER_WEB_LOGIN_01    | Đăng nhập thành công với tài khoản Customer tồn tại qua /login | - Tài khoản customer1@gmail.com tồn tại trong bảng account với GoogleID: 12345, role: customer, status: Active. <br> - Server API đang chạy tại http://localhost/API_Secu | 1. Truy cập trang chủ web (http://localhost:80/API_Security/design/pages/trangchu). <br> 2. Nhấn nút "Đăng nhập với Google". <br> 3. Nhập customer1@gmail.com và cấp quyền qua Google OAuth. <br> 4. Gửi yêu cầu POST đến /login với CSRF token và Google ID token. <br> 5. Kiểm tra phản hồi API và giao diện. | Request: POST /app_login <br> Header: Authorization: Bearer <Google_ID_Token>, X-CSRF-Token: <valid_csrf_token> <br> Body: { "GoogleID": "12345", "email": "customer1@gmail.com", "FullName": "Nguyen Van A", "access_token": "valid_access_token", "expires_at": "2025-06-01 12:00:00" } | Response: HTTP 200 OK, JSON { "status": "success", "token": "<JWT_token>", "message": "Đăng nhập thành công", "role": "customer", "status": "Active" }. <br> Giao diện chuyển sang dashboard Customer với các chức năng xem/sửa thông tin, gói bảo hiểm, hợp đồng. <br> Thông báo: "Đăng nhập thành công". | Response: HTTP 200 OK, JSON { "status": "success", "token": "<JWT_token>", "message": "Đăng nhập thành công", "role": "customer", "status": "Active" }. <br> Dashboard Customer hiển thị đúng. <br> Thông báo: "Đăng nhập thành công". | P |
| TC_CUSTOMER_WEB_LOGIN_02    | Đăng nhập thất bại với tài khoản Customer bị chặn qua /login | - Tài khoản blockedcustomer@gmail.com tồn tại với GoogleID: 67890, role: customer, status: Blocked. <br> - Server API đang chạy. | 1. Truy cập trang chủ web. <br> 2. Nhấn nút "Đăng nhập với Google". <br> 3. Nhập blockedcustomer@gmail.com. <br> 4. Gửi yêu cầu POST đến /login với CSRF token. <br> 5. Kiểm tra phản hồi API và giao diện. | Request: POST /app_login <br> Header: Authorization: Bearer <Google_ID_Token>, X-CSRF-Token: <valid_csrf_token> <br> Body: { "GoogleID": "67890", "email": "blockedcustomer@gmail.com", "FullName": "Nguyen Van B", "access_token": "valid_access_token", "expires_at": "2025-06-01 12:00:00" } | Response: HTTP 200 OK, JSON { "status": "success", "token": "<JWT_token>", "message": "Đăng nhập thành công", "role": "customer", "status": "Blocked" }. <br> Giao diện hiển thị thông báo lỗi: "Tài khoản bị chặn". <br> Vẫn ở trang đăng nhập. | Response: HTTP 200 OK, JSON { "status": "success", "token": "<JWT_token>", "message": "Đăng nhập thành công", "role": "customer", "status": "Blocked" }. <br> Thông báo lỗi hiển thị đúng. <br> Giao diện không chuyển. | P |

### 5.3.2. Trường hợp Kiểm thử Actor Admin (Nền tảng Web)
| ID trường hợp thử nghiệm    | Mô tả trường hợp thử nghiệm                              | Tiền điều kiện                                                                 | Các bước kiểm tra                                                                 | Dữ liệu thử nghiệm                                                                                   | Kết quả mong đợi                                                                                           | Kết quả thực tế                                                                                           | Vượt qua/thất bại (P/F) |
|-----------------------------|----------------------------------------------------------|--------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|-------------------------|
| TC_ADMIN_WEB_ADDUSER_01     | Thêm Admin mới thành công                               | - Admin admin1@gmail.com đã đăng nhập. <br> - Server API đang chạy.           | 1. Vào trang quản lý người dùng. <br> 2. Nhấn nút "Thêm Admin". <br> 3. Nhập thông tin người dùng mới. <br> 4. Nhấn "Lưu". <br> 5. Kiểm tra giao diện và bảng account, admin trong MySQL. | Email: newadmin@gmail.com <br> FullName: "Nguyen Van A" <br> Role: admin <br> Status: Active | Thông báo: "Thêm Admin thành công". <br> Bảng account và admin có bản ghi mới với email newadmin@gmail.com. <br> Danh sách người dùng trên giao diện cập nhật. | Thông báo: "Thêm Admin thành công". <br> Bảng account và admin có bản ghi mới. <br> Danh sách người dùng cập nhật đúng. | P |
| TC_ADMIN_WEB_ADDUSER_02     | Thêm Admin với email đã tồn tại                         | - Admin admin1@gmail.com đã đăng nhập. <br> - Tài khoản existing@gmail.com đã tồn tại. <br> - Server API đang chạy. | 1. Vào trang quản lý người dùng. <br> 2. Nhấn nút "Thêm Admin". <br> 3. Nhập thông tin với email đã tồn tại. <br> 4. Nhấn "Lưu". <br> 5. Kiểm tra giao diện và cơ sở dữ liệu. | Email: existing@gmail.com <br> FullName: "Nguyen Van B" <br> Role: admin <br> Status: Active | Thông báo lỗi: "Email đã tồn tại". <br> Cơ sở dữ liệu không có bản ghi mới. | Thông báo lỗi: "Email này đã được sử dụng cho tài khoản khác". <br> Cơ sở dữ liệu không thay đổi. | P |
| TC_ADMIN_WEB_EDITUSER_01    | Sửa thông tin Khách hàng thành công                     | - Admin admin1@gmail.com đã đăng nhập. <br> - Tài khoản Khách hàng customer1@gmail.com tồn tại. <br> - Server API đang chạy. | 1. Vào trang quản lý người dùng. <br> 2. Chọn Khách hàng customer1@gmail.com. <br> 3. Nhấn "Sửa". <br> 4. Cập nhật số điện thoại. <br> 5. Nhấn "Lưu". <br> 6. Kiểm tra giao diện và bảng account. | Email: customer1@gmail.com <br> Phone: "0987654321" | Thông báo: "Cập nhật thành công". <br> Bảng account cập nhật số điện thoại mới cho customer1@gmail.com. <br> Giao diện hiển thị thông tin đã cập nhật. | Thông báo: "Cập nhật thành công". <br> Bảng account cập nhật đúng số điện thoại. <br> Giao diện hiển thị thông tin mới. | P |
| TC_ADMIN_WEB_DELETEUSER_01  | Xóa Khách hàng thành công                               | - Admin admin1@gmail.com đã đăng nhập. <br> - Tài khoản Khách hàng customer2@gmail.com tồn tại. <br> - Server API đang chạy. | 1. Vào trang quản lý người dùng. <br> 2. Chọn Khách hàng customer2@gmail.com. <br> 3. Nhấn "Xóa". <br> 4. Xác nhận xóa. <br> 5. Kiểm tra giao diện và bảng account, customer. | Email: customer2@gmail.com | Thông báo: "Xóa thành công". <br> Bản ghi customer2@gmail.com bị xóa khỏi bảng account và customer. <br> Danh sách người dùng cập nhật. | Thông báo: "Xóa thành công". <br> Bản ghi bị xóa đúng. <br> Danh sách người dùng cập nhật. | P |

## 5.3.4. Trường hợp Kiểm thử Bảo mật API
| ID trường hợp thử nghiệm    | Mô tả trường hợp thử nghiệm                              | Tiền điều kiện                                                                 | Các bước kiểm tra                                                                 | Dữ liệu thử nghiệm                                                                                   | Kết quả mong đợi                                                                                           | Kết quả thực tế                                                                                           | Vượt qua/thất bại (P/F) |
|-----------------------------|----------------------------------------------------------|--------------------------------------------------------------------------------|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|-------------------------|
| TC_Token_Stored_01          | Kiểm tra token trong thư mục tokens được mã hóa          | - Đăng nhập bằng Google OAuth với email tuchuc848@gmail.com. <br> - Thư mục tokens đã được tạo trong TaskManagerApp/tokens. | 1. Đăng nhập bằng Google OAuth với email tuchuc848@gmail.com. <br> 2. Mở thư mục C:\Users\PC\OneDrive - Industrial University of HoChiMinh City\Documents\NetBeansProjects\TaskManagerApp\tokens. <br> 3. Kiểm tra nội dung tệp StoredCredential. | Nội dung tệp StoredCredential là chuỗi mã hóa (dạng Base64, không đọc được trực tiếp). | - Response: {"error": "403 Forbidden - CSRF token missing or invalid"}. <br> - Bảng account không có bản ghi mới. | - Response: {"error": "403 Forbidden - CSRF token missing or invalid"}. <br> - Bảng account không có bản ghi mới. <br> - Log: " Invalid CSRF token ". | P (do thiếu CSRF token, đây là hành vi bảo mật mong đợi) |
| TC_API_Secu_01              | Gửi request POST tới /add để thêm người dùng mới nhưng không kèm theo csrf token. | - Token hợp lệ của admin (tuchuc34@gmail.com) đã được tạo. <br> - CSRF token chưa được gửi. <br> - Server API (http://localhost/API_Secu) đang chạy. | 1. Gửi request POST tới http://localhost/API_Secu/add với: <br> Header: Authorization: Bearer <auth_token>, Content-Type: application/json. <br> Body: {"email": "tuchuc34@gmail.com", "role": "customer", "status": "Active"}. <br> 4. Kiểm tra response và bảng account. | - email: tuchuc34@gmail.com <br> - token được cấp của user sau khi đăng nhập | - Response: {"error": "403 Forbidden - CSRF token missing or invalid"}. <br> - Bảng account không có bản ghi mới. | - Response: {"error": "403 Forbidden - CSRF token missing or invalid"}. <br> - Bảng account không có bản ghi mới. <br> - Log: " Invalid CSRF token ". | P (do thiếu CSRF token, đây là hành vi bảo mật mong đợi) |
| TC_API_Secu_02              | Gửi request POST tới /add có kèm csrf token hợp lệ.      | - Token hợp lệ của admin (tuchuc34@gmail.com) đã được tạo. <br> - CSRF token hợp lệ (csrf_token: "valid_token") được tạo từ server và gửi. <br> - Server API đang chạy. | 1. Gửi request POST tới http://localhost/API_Secu/add với: <br> Header: Authorization: Bearer <auth_token>, Content-Type: application/json, X-CSRF-Token: valid_token. <br> Body: {"email": "tuchuc34@gmail.com", "role": "customer", "status": "Active"}. <br> 2. Kiểm tra response và bảng account. | - Email: tuchuc34@gmail.com <br> - Auth Token <br> - Csrf token | - Response: {"status": "success", "message": "Thêm người dùng thành công"}. <br> - Bảng account chứa bản ghi mới: email: "tuchuc34@gmail.com", role: "customer", status: "Active". | - Response: {"status": "success", "message": "Thêm người dùng thành công"}. <br> - Bảng account chứa bản ghi: email: "tuchuc34@gmail.com", role: "customer", status: "Active". | P |
| TC_API_Secu_03              | Kiểm tra chống SQL Injection trên /AdminUpdate           | - User tuchuc848@gmail.com (admin) đã đăng nhập. <br> - Server API đang chạy. | 1. Gửi request POST tới http://localhost/API_Secu/AdminUpdate với dữ liệu đầu vào chứa mã độc: <br> Header: Authorization: Bearer <token>, Content-Type: application/json. <br> Body: {"email": "tuchuc848@gmail.com", "role": "' OR '1'='1", "status": "Active", "csrf_token": "<valid_csrf_token>"}. <br> 2. Kiểm tra response và database. | email: "tuchuc848@gmail.com", role: "' OR '1'='1", status: "Active", csrf_token: "<valid_csrf_token> | - Response: {"status": "success", "message": "Cập nhật thành công"}. <br> - Database không bị thay đổi bất thường (role không bị thay đổi thành giá trị bất hợp lệ). | - Response: {"status": "success", "message": "Cập nhật thành công"}. <br> - Database cập nhật đúng: role vẫn là "' OR '1'='1" (được xử lý như chuỗi, không phải mã SQL). | (Không ghi P/F, cần kiểm tra lại) |

## Công cụ Sử dụng
- Postman cho xác thực API.
- OWASP ZAP cho quét bảo mật.

## Kết quả
Chi tiết và ảnh chụp màn hình có sẵn trong `docs/Test_Reports/Test_Report.pdf` và `docs/Screenshots`.
