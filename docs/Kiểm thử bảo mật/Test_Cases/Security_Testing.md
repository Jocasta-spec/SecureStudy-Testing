# 23 Test Cases Bảo Mật – SecureStudy 

## Phần 1: Authentication, CSRF, SQL Injection (12 test cases)

| Lỗ hổng       | Test ID             | Mô tả ngắn gọn                                   | Kết quả |
|---------------|---------------------|--------------------------------------------------|---------|
| Auth          | TC_WEB_01           | Web – Đăng nhập OAuth → nhận JWT thành công      | P       |
| Auth          | TC_WEB_02           | Web – Tài khoản bị blocked vẫn bị chặn           | P       |
| Auth          | TC_APP_02           | App – User không tồn tại → báo lỗi               | P       |
| Auth          | TC_APP_04           | App – Admin bị blocked → không vào được          | P       |
| Auth          | TC_LOGOUT_03        | Đăng xuất → xóa token khỏi Preferences & DB      | P       |
| CSRF          | TC_API_01           | POST /add thiếu CSRF token → 403 Forbidden       | P       |
| CSRF          | TC_API_02           | POST /add có CSRF token hợp lệ → thành công      | P       |
| CSRF          | TC_Token_01         | Token lưu trữ được mã hóa Base64                 | P       |
| SQLi          | TC_SQLi-V1          | Payload `' OR '1'='1` → bị chặn (prepared stmt)  | P       |
| SQLi          | TC_SQLi-Where       | Bypass WHERE clause → bị chặn                    | P       |
| SQLi          | TC_SQLi-Table       | DROP TABLE trong input → bị chặn                 | P       |
| SQLi          | TC_SQLi-Spec        | Prepared statements hoạt động đúng               | P       |

### Chi tiết các test case Phần 1

| Test ID         | Tên đầy đủ & mô tả                                                                                           | Tiền điều kiện                                                                                              | Các bước thực hiện                                                                                                                                                                                                                                   | Dữ liệu thử nghiệm                                                                                                                                                          | Kết quả mong đợi                                                                                                                                                                                                                          | Kết quả thực tế                                                                                                                                                                                                                          | P/F |
|-----------------|--------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----|
| TC_WEB_01       | Đăng nhập thành công với tài khoản Teacher (Web)                                                            | Tài khoản Teacher1@gmail.com tồn tại, status = Active                                                         | 1. Truy cập trang chủ web<br>2. Nhấn “Đăng nhập với Google”<br>3. Cấp quyền OAuth<br>4. Gửi POST /app_login với CSRF token hợp lệ                                                  | POST /app_login, Header: X-CSRF-Token + Bearer Google token<br>Body: {email, GoogleID, …}                                                                                | HTTP 200, trả về JWT, chuyển sang dashboard Teacher, thông báo “Đăng nhập thành công”                                                                                   | Đúng như mong đợi                                                                                                                                                                                                                        | P   |
| TC_WEB_02       | Tài khoản Teacher bị blocked (Web)                                                                          | Tài khoản blockedTeacher@gmail.com có status = Blocked                                                        | Tương tự TC_WEB_01 nhưng dùng email bị blocked                                                                                                                                                                                                       | Email: blockedTeacher@gmail.com                                                                                                                                            | Thông hiển thị thông báo “Tài khoản bị chặn”, không chuyển trang                                                                                                             | Thông báo hiển thị đúng, không chuyển trang                                                                                                                                                                                              | P   |
| TC_APP_02       | Đăng nhập App với user không tồn tại                                                                        | User camtu18@gmail.com chưa có trong DB                                                                        | 1. Mở Java Desktop App<br>2. Nhập email chưa tồn tại<br>3. Nhấn “Đăng nhập với Google”                                                                                             | Email: camtu18@gmail.com                                                                                                                                                    | Response: {"error": "Tài khoản không tồn tại…"} + thông báo trên UI                                                                                                       | Đúng như mong đợi                                                                                                                                                                                                                        | P   |
| TC_APP_04       | Đăng nhập App với admin bị blocked                                                                           | User camtu7092003@gmail.com có status = Blocked                                                                | Tương tự TC_APP_02 nhưng dùng email admin bị blocked                                                                                                                                                                                                | Email: camtu7092003@gmail.com                                                                                                                                              | Thông báo “Bạn chưa được cấp quyền… đã bị chặn”, không vào TaskPanel                                                                                                      | Đúng như mong đợi                                                                                                                                                                                                                        | P   |
| TC_LOGOUT_03    | Đăng xuất → xóa token                                                                                        | Đã đăng nhập thành công, token lưu trong Preferences & bảng user_tokens                                       | 1. Nhấn nút “Đăng xuất” trên TaskPanel<br>2. Kiểm tra giao diện và DB                                                                                                                | –                                                                                                                                                                           | Quay về LoginPanel, token bị xóa hoàn toàn                                                                                                                                | Token bị xóa hoàn toàn, giao diện về LoginPanel                                                                                                                          | P   |
| TC_API_01       | Thiếu CSRF token → 403                                                                                       | Có JWT hợp lệ của admin                                                                                       | Gửi POST http://localhost/API_Secu/add không có header X-CSRF-Token                                                                                                                 | Body: {"email":"new@gmail.com", "role":"Teacher"}                                                                                                                          | {"error":"403 Forbidden - CSRF token missing or invalid"}                                                                                                                | Đúng như mong đợi, DB không thêm bản ghi                                                                                                                                | P   |
| TC_API_02       | CSRF token hợp lệ → thành công                                                                               | Có JWT + CSRF token hợp lệ                                                                                     | Gửi POST /add kèm header X-CSRF-Token hợp lệ                                                                                                                                        | Header: X-CSRF-Token: valid_token                                                                                                                                          | {"status":"success","message":"Thêm người dùng thành công"} + bản ghi mới trong bảng account                                                                              | Đúng như mong đợi                                                                                                                                                                                                                        | P   |
| TC_Token_01     | Token lưu trữ được mã hóa Base64                                                                             | Đã đăng nhập bằng Google OAuth                                                                                 | Kiểm tra file StoredCredential trong thư mục tokens                                                                                                                                | –                                                                                                                                                                           | Nội dung file là chuỗi Base64 không đọc được trực tiếp                                                                                                                   | Đúng như mong đợi                                                                                                                                                                                                                        | P   |
| TC_SQLi-V1      | SQL Injection cơ bản `' OR '1'='1` trên /AdminUpdate                                                         | Đã đăng nhập admin                                                                                             | POST /AdminUpdate với Phone = `' OR '1'='1`                                                                                                                                          | {"email":"abc@gmail.com", "Phone":"' OR '1'='1","status":"Active"}                                                                                                                                    | Cập nhật thành công nhưng role được lưu nguyên dạng chuỗi (không bypass)                                                                                                  | Payload được lưu như chuỗi bình thường, không bypass                                                                                                                    | P   |
| TC_SQLi-Where   | Bypass WHERE clause                                                                                          | Đã đăng nhập admin                                                                                                  | POST /AdminUpdate với Payload: `1=1 OR '1'='1 --`                                                                                                                                                          | {"table": "teacher", "email": "abc@gmail.com", "where": "1=1 OR '1'='1"}                                                                                                                                                                           | Không bypass được, chỉ cập nhật đúng bản ghi của user hiện tại                                                                                                           | Không bypass được                                                                                                                                                                                                                        | P   |
| TC_SQLi-Table   | DROP TABLE trong input                                                                                       | Đã đăng nhập admin                                                                                                  | POST /AdminUpdate với Payload: `account; DROP TABLE account --`                                                                                                                                             | {"table": "account; DROP TABLE account; --"}                                                                                                                                                                           | Không thực thi lệnh DROP, chỉ lưu như chuỗi                                                                                                                               | Không ảnh hưởng đến cấu trúc DB                                                                                                                                                                                                          | P   |
| TC_SQLi-Spec   | tấn công multiInsert (nhiều bản ghi) → Kiểm chứng prepared statements đa giá trị                                                                                       | Đã đăng nhập admin                                                                                                  | POST /add với nhiều bản ghi trong value --`                                                                                                                                             | {"table": "account", "columns": ["FullName", "Email"], "values": [["A'; DROP TABLE account; --", "a@gmail.com"],["B", "b@gmail.com"]]}                                                                                                                                                                           | Mỗi phần tử trong values đều được bind riêng bằng prepared statement.<br>DB lưu literal "A'; DROP TABLE users; --" như chuỗi bình thường.<br>Không có câu lệnh phụ nào được thực thi
                                                                                                                               | Đúng như mong đợi                                                                                                                                                                                                           | P   |

## Phần 2: RBAC & CRUD / Input Validation (11 test cases)

| Lỗ hổng             | Test ID             | Mô tả ngắn gọn                                          | Kết quả |
|---------------------|---------------------|---------------------------------------------------------|---------|
| RBAC                | TC_ROLE_03          | Admin vào được TaskPanel, Teacher bị chặn              | P       |
| RBAC                | TC_ADD_01           | Chỉ admin mới thêm được user                            | P       |
| RBAC                | TC_GET_03           | Không lộ thông tin người dùng khác (IDOR)               | P       |
| CRUD/Input Valid    | TC_ADD_04           | Email trùng → báo lỗi, không thêm                       | P       |
| CRUD/Input Valid    | TC_WEB_ADD_02       | Web – Email trùng → báo lỗi                             | P       |
| CRUD/Input Valid    | TC_ADD_03           | Thêm user mới thành công                                | P       |
| CRUD/Input Valid    | TC_UPDATE_03        | Sửa thông tin user thành công                           | P       |
| CRUD/Input Valid    | TC_DELETE_03        | Xóa user thành công                                     | P       |
| CRUD/Input Valid    | TC_WEB_EDIT_01      | Web – Sửa thông tin khách hàng thành công               | P       |
| CRUD/Input Valid    | TC_WEB_DEL_01       | Web – Xóa khách hàng thành công                         | P       |
| CRUD/Input Valid    | TC_GET_03 (lặp)     | Hiển thị danh sách user đầy đủ & refresh không mất dữ liệu | P       |

### Chi tiết các test case Phần 2 (chỉ liệt kê những case chính đã đạt P)

| Test ID           | Tên & mô tả                                                                 | Tiền điều kiện                                      | Các bước chính                                                                 | Dữ liệu thử nghiệm                              | Kết quả thực tế thực tế (Pass)                                                                                       | P/F |
|-------------------|-----------------------------------------------------------------------------|-----------------------------------------------------|--------------------------------------------------------------------------------|-------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|-----|
| TC_ROLE_03        | Phân quyền: Admin->AdminDashboard, Teacher->TeacherDashboard                                      | 2 user: admin (Active) + Teacher (Active)          | Đăng nhập lần lượt 2 tài khoản → kiểm tra giao diện                           | Email admin & Teacher                          | Admin → AdminDashboard<br>Teacher → hiển thị TeacherDashboard                                             | P   |
| TC_ADD_03         | Thêm user mới thành công (App)                                              | Đăng nhập admin                                     | Nhấn “Thêm Người dùng” → nhập thông tin → Lưu                                  | email: testuser21@gmail.com, tên, sdt           | Bản ghi mới xuất hiện trong JTable + DB                                                                     | P   |
| TC_ADD_04         | Thêm user với email đã tồn tại → báo lỗi                                    | Email testuser22@gmail.com đã tồn tại               | Thử thêm lại cùng email                                                        | email: testuser22@gmail.com                     | Thông báo “Email này đã được sử dụng…” → không thêm bản ghi mới                                             | P   |
| TC_UPDATE_03      | Sửa thông tin user thành công (App)                                         | Đăng nhập admin, có user testuser21                 | Chọn user → Sửa → đổi sdt → Lưu                                                | phone: 7878                                     | JTable + DB cập nhật đúng số điện thoại mới                                                                | P   |
| TC_DELETE_03      | Xóa user thành công (App)                                                   | Đăng nhập admin, có user testuser21                 | Chọn user → Xóa → xác nhận                                                     | email: testuser21@gmail.com                     | Bản ghi bị xóa khỏi JTable + DB                                                                             | P   |
| TC_WEB_ADD_02     | Web – Thêm admin với email đã tồn tại                                       | Đăng nhập admin web                                 | Vào quản lý → Thêm người dùng → nhập email đã có                                    | existing@gmail.com                              | Thông báo “Email này đã được sử dụng…” → không thêm                                                         | P   |
| TC_WEB_EDIT_01    | Web – Sửa thông tin người dùng thành công                                   | Đăng nhập admin web                                 | Chọn người dùng → Sửa → đổi sdt → Lưu                                          | phone: 0987654321                               | Thông báo “Cập nhật thành công”, DB + giao diện cập nhật                                                    | P   |
| TC_WEB_DEL_01     | Web – Xóa người dùng thành công                                             | Đăng nhập admin web                                 | Chọn người dùng → Xóa → xác nhận                                               | Teacher2@gmail.com                             | Thông báo “Xóa thành công”, bản ghi biến mất khỏi DB + danh sách                                           | P   |
| TC_GET_03         | Hiển thị danh sách user đầy đủ + refresh không mất dữ liệu                 | Đăng nhập admin                                     | Vào AdminDashboard → xem bảng → nhấn Refresh nhiều lần                             | –                                               | Dữ liệu luôn hiển thị đúng, không bị null, không mất khi refresh                                            | P   |
